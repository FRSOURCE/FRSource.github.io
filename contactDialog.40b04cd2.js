!function(e,t,r,a,o,n,i,c){var l="u">typeof globalThis?globalThis:"u">typeof self?self:"u">typeof window?window:"u">typeof global?global:{},s="function"==typeof l[a]&&l[a],u=s.i||{},p=s.cache||{},d="u">typeof module&&"function"==typeof module.require&&module.require.bind(module);function f(t,r){if(!p[t]){if(!e[t]){if(o[t])return o[t];var n="function"==typeof l[a]&&l[a];if(!r&&n)return n(t,!0);if(s)return s(t,!0);if(d&&"string"==typeof t)return d(t);var i=Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}u.resolve=function(r){var a=e[t][1][r];return null!=a?a:r},u.cache={};var c=p[t]=new f.Module(t);e[t][0].call(c.exports,u,c,c.exports,l)}return p[t].exports;function u(e){var t=u.resolve(e);if(!1===t)return{};if(Array.isArray(t)){var r={__esModule:!0};return t.forEach(function(e){var t=e[0],a=e[1],o=e[2]||e[0],n=f(a);"*"===t?Object.keys(n).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})}):"*"===o?Object.defineProperty(r,t,{enumerable:!0,value:n}):Object.defineProperty(r,t,{enumerable:!0,get:function(){return"default"===o?n.__esModule?n.default:n:n[o]}})}),r}return f(t)}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.require=d,this.exports={}},f.modules=e,f.cache=p,f.parent=s,f.distDir=void 0,f.publicUrl=void 0,f.devServer=void 0,f.i=u,f.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(f,"root",{get:function(){return l[a]}}),l[a]=f;for(var h=0;h<t.length;h++)f(t[h])}({"4Vh0U":[function(e,t,r,a){var o=e("@parcel/transformer-js/src/esmodule-helpers.js");o.defineInteropFlag(r),o.export(r,"ContactDialogCtrl",()=>c);var n=e("url:./tpl.html"),i=o.interopDefault(n);e("./_styles.scss");class c{constructor(){this.grecaptchaCallbackResolver=()=>{},c.grecaptchaScriptLoader||this.createScriptElement(),this.element=document.createElement("dialog"),this.setupDialogElement(this.element)}async setupDialogElement(e){c.templateLoader||(c.templateLoader=fetch(i.default));let t=await c.templateLoader;e.innerHTML=await t.text(),e.querySelectorAll("input,textarea").forEach(e=>{e.setAttribute("placeholder"," ")}),e.querySelector(".dialog__btn-close").addEventListener("click",this.hide.bind(this)),e.querySelector(".gform").addEventListener("submit",this.onFormSubmit.bind(this)),this.element=e}createScriptElement(){c.grecaptchaScriptLoader=new Promise(e=>{let t=document.createElement("script");t.onload=()=>{let t=document.createElement("div");t.className="grecaptcha-wrapper",document.body.appendChild(t),window.grecaptcha.ready(()=>{window.grecaptcha.render(t,{sitekey:"6LdQaM8ZAAAAAJwBCtGEYIyh9u6be1rBOlsd-FWj",size:"invisible",callback:e=>this.grecaptchaCallbackResolver(e)}),e()})},t.src="https://www.google.com/recaptcha/api.js?render=explicit",t.defer=!0,t.async=!0,document.body.appendChild(t)})}async executeGrecaptcha(){let e=await new Promise(e=>{this.grecaptchaCallbackResolver=e,window.grecaptcha.execute()});return window.grecaptcha.reset(),e}async sendContactData(e,t=0){let r="https://script.google.com/macros/s/AKfycbzrISB5QwRuuwGTgkxgKp7DGENDHPcxZTcka2_LRQ0zULSf5Ec/exec?"+e,a=await this.executeGrecaptcha(),o=await fetch(r+"&token="+encodeURIComponent(a),{redirect:"follow",method:"POST",headers:{"Content-Type":"text/plain;charset=utf-8"}});if("success"!==(await o.json()).result){if(++t<3)return this.sendContactData(e,t);throw Error("Failed to submit contact form")}}isShown(){return"open"===this.element.getAttribute("open")}show(){requestAnimationFrame(()=>{this.element.setAttribute("open","open")})}hide(){this.element.removeAttribute("open")}async onFormSubmit(e){await c.grecaptchaScriptLoader;let t=e.currentTarget,r=t.querySelector("button");r.disabled=!0,e.preventDefault();let a=Array.prototype.slice.apply(t.querySelectorAll("input,textarea")).map(e=>encodeURIComponent(e.name)+"="+encodeURIComponent(e.value)).join("&");await this.sendContactData(a).then(()=>{r.textContent="THX!",r.classList.remove("fill"),r.classList.add("pe-n")},()=>{r.textContent="ERROR! Try later.",r.classList.remove("fill"),r.classList.add("pe-n")}),r.disabled=!1}}},{"url:./tpl.html":"3Jr4D","./_styles.scss":"8QASm","@parcel/transformer-js/src/esmodule-helpers.js":"cQf6i"}],"3Jr4D":[function(e,t,r,a){t.exports=import.meta.resolve("KXJBD")},{}],"8QASm":[function(){},{}]},[],0,"parcelRequire6566",{});
//# sourceMappingURL=contactDialog.40b04cd2.js.map
