!// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
function(e,t,r,n,a){/* eslint-disable no-undef */var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i="function"==typeof o[n]&&o[n],c=i.cache||{},s="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function l(t,r){if(!c[t]){if(!e[t]){// if we cannot find the module within our internal map or
// cache jump to the current global require ie. the last bundle
// that was added to the page.
var a="function"==typeof o[n]&&o[n];if(!r&&a)return a(t,!0);// If there are other bundles on this page the require from the
// previous one is saved to 'previousRequire'. Repeat this as
// many times as there are bundles until the module is found or
// we exhaust the require chain.
if(i)return i(t,!0);// Try the node require function if it exists.
if(s&&"string"==typeof t)return s(t);var d=Error("Cannot find module '"+t+"'");throw d.code="MODULE_NOT_FOUND",d}p.resolve=function(r){var n=e[t][1][r];return null!=n?n:r},p.cache={};var u=c[t]=new l.Module(t);e[t][0].call(u.exports,p,u,u.exports,this)}return c[t].exports;function p(e){var t=p.resolve(e);return!1===t?{}:l(t)}}l.isParcelRequire=!0,l.Module=function(e){this.id=e,this.bundle=l,this.exports={}},l.modules=e,l.cache=c,l.parent=i,l.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(l,"root",{get:function(){return o[n]}}),o[n]=l;for(var d=0;d<t.length;d++)l(t[d]);if(r){// Expose entry point to Node, AMD or browser globals
// Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
var u=l(r);// CommonJS
"object"==typeof exports&&"undefined"!=typeof module?module.exports=u:"function"==typeof define&&define.amd?define(function(){return u}):a&&(this[a]=u)}}({asAuK:[function(e,t,r){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"ContactDialogCtrl",()=>i);var a=e("url:./tpl.html"),o=n.interopDefault(a);e("./_styles.scss");class i{constructor(){this.grecaptchaCallbackResolver=()=>{},i.grecaptchaScriptLoader||this.createScriptElement(),this.element=document.createElement("dialog"),this.setupDialogElement(this.element)}async setupDialogElement(e){i.templateLoader||(i.templateLoader=fetch(o.default));let t=await i.templateLoader;e.innerHTML=await t.text(),e.querySelectorAll("input,textarea").forEach(e=>{e.setAttribute("placeholder"," ");// to let 'placeholder-shown' styling to kick in
}),e.querySelector(".dialog__btn-close").addEventListener("click",this.hide.bind(this)),e.querySelector(".gform").addEventListener("submit",this.onFormSubmit.bind(this)),this.element=e}createScriptElement(){i.grecaptchaScriptLoader=new Promise(e=>{let t=document.createElement("script");t.onload=()=>{let t=document.createElement("div");t.className="grecaptcha-wrapper",document.body.appendChild(t),window.grecaptcha.ready(()=>{window.grecaptcha.render(t,{sitekey:"6LdQaM8ZAAAAAJwBCtGEYIyh9u6be1rBOlsd-FWj",size:"invisible",callback:e=>this.grecaptchaCallbackResolver(e)}),e()})},t.src="https://www.google.com/recaptcha/api.js?render=explicit",t.defer=!0,t.async=!0,document.body.appendChild(t)})}async executeGrecaptcha(){let e=await new Promise(e=>{this.grecaptchaCallbackResolver=e,window.grecaptcha.execute()});return window.grecaptcha.reset(),e}async sendContactData(e,t=0){return new Promise(async(r,n)=>{let a="https://script.google.com/macros/s/AKfycbzrISB5QwRuuwGTgkxgKp7DGENDHPcxZTcka2_LRQ0zULSf5Ec/exec?"+e,o=await this.executeGrecaptcha(),i=new XMLHttpRequest;i.open("POST",a+"&token="+encodeURIComponent(o)),i.setRequestHeader("Content-type","text/plain;charset=utf-8"),i.onreadystatechange=()=>{if(4===i.readyState){if(200===i.status){let a=JSON.parse(i.responseText);if("success"===a.result)return r();++t<3?r(this.sendContactData(e,t)):n()}else n()}},i.send()})}isShown(){return"open"===this.element.getAttribute("open")}show(){requestAnimationFrame(()=>{this.element.setAttribute("open","open")})}hide(){this.element.removeAttribute("open")}async onFormSubmit(e){await i.grecaptchaScriptLoader;let t=e.currentTarget,r=t.querySelector("button");r.disabled=!0,e.preventDefault();let n=Array.prototype.slice.apply(t.querySelectorAll("input,textarea")).map(e=>encodeURIComponent(e.name)+"="+encodeURIComponent(e.value)).join("&");await this.sendContactData(n).then(()=>{r.textContent="THX!",r.classList.remove("fill"),r.classList.add("pe-n")},()=>{}),r.disabled=!1}}},{"url:./tpl.html":"dA4ar","./_styles.scss":"8QASm","@parcel/transformer-js/src/esmodule-helpers.js":"bUjUS"}],dA4ar:[function(e,t,r){t.exports=e("95da23267e1220bd").getBundleURL("iGomz")+e("958cc2a9d5238f18").resolve("6kmWC")},{"95da23267e1220bd":"2Dkqa","958cc2a9d5238f18":"gcGNu"}],"8QASm":[function(){},{}]},[],null,"parcelRequire6566")//# sourceMappingURL=contactDialog.31cb0a93.js.map
;
//# sourceMappingURL=contactDialog.31cb0a93.js.map
