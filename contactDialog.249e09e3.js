!function(e,t,n,r,a){var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s="function"==typeof o.parcelRequire666c&&o.parcelRequire666c,l=s.cache||{},c="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function i(t,n){if(!l[t]){if(!e[t]){var r="function"==typeof o.parcelRequire666c&&o.parcelRequire666c;if(!n&&r)return r(t,!0);if(s)return s(t,!0);if(c&&"string"==typeof t)return c(t);var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}d.resolve=function(n){return e[t][1][n]||n},d.cache={};var p=l[t]=new i.Module(t);e[t][0].call(p.exports,d,p,p.exports,this)}return l[t].exports;function d(e){return i(d.resolve(e))}}i.isParcelRequire=!0,i.Module=function(e){this.id=e,this.bundle=i,this.exports={}},i.modules=e,i.cache=l,i.parent=s,i.register=function(t,n){e[t]=[function(e,t){t.exports=n},{}]},Object.defineProperty(i,"root",{get:function(){return o.parcelRequire666c}}),o.parcelRequire666c=i;for(var p=0;p<t.length;p++)i(t[p])}({"32x10":[function(e,t,n){var r=e("@parcel/transformer-js/lib/esmodule-helpers.js");r.defineInteropFlag(n),r.export(n,"ContactDialogCtrl",(function(){return s}));var a=e("bundle-text:./tpl.html"),o=r.interopDefault(a);e("./_styles.scss");class s{grecaptchaCallbackResolver=()=>{};constructor(){s.grecaptchaScriptLoader||this.createScriptElement(),this.element=document.createElement("dialog"),this.element.innerHTML=o.default,this.element.querySelector(".dialog__btn-close").addEventListener("click",this.hide.bind(this)),this.element.querySelector(".gform").addEventListener("submit",this.onFormSubmit.bind(this))}createScriptElement(){s.grecaptchaScriptLoader=new Promise((e=>{const t=document.createElement("script");t.onload=()=>{const t=document.createElement("div");t.className="grecaptcha-wrapper",document.body.appendChild(t),window.grecaptcha.ready((()=>{window.grecaptcha.render(t,{sitekey:"6LdQaM8ZAAAAAJwBCtGEYIyh9u6be1rBOlsd-FWj",size:"invisible",callback:e=>this.grecaptchaCallbackResolver(e)}),e()}))},t.src="https://www.google.com/recaptcha/api.js?render=explicit",t.defer=!0,t.async=!0,document.body.appendChild(t)}))}async executeGrecaptcha(){const e=await new Promise((e=>{this.grecaptchaCallbackResolver=e,window.grecaptcha.execute()}));return window.grecaptcha.reset(),e}async sendContactData(e,t=0){return new Promise((async(n,r)=>{const a="https://script.google.com/macros/s/AKfycbzrISB5QwRuuwGTgkxgKp7DGENDHPcxZTcka2_LRQ0zULSf5Ec/exec?"+e,o=await this.executeGrecaptcha(),s=new XMLHttpRequest;s.open("POST",a+"&token="+encodeURIComponent(o)),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onreadystatechange=()=>{if(4===s.readyState&&200===s.status){if("success"===JSON.parse(s.responseText).result)return n();++t<3?n(this.sendContactData(e,t)):r()}},s.send()}))}isShown(){return"open"===this.element.getAttribute("open")}show(){this.element.setAttribute("open","open")}hide(){this.element.removeAttribute("open")}async onFormSubmit(e){await s.grecaptchaScriptLoader;const t=e.currentTarget,n=t.querySelector("button");n.disabled=!0,e.preventDefault();const r=Array.prototype.slice.apply(t.querySelectorAll("input,textarea")).map((e=>encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))).join("&");await this.sendContactData(r).then((()=>{n.textContent="THX!",n.classList.remove("fill"),n.classList.add("pe-n")}),(()=>{})),n.disabled=!1}}},{"bundle-text:./tpl.html":"6xAUF","./_styles.scss":"3YWBy","@parcel/transformer-js/lib/esmodule-helpers.js":"5gA8y"}],"6xAUF":[function(e,t,n){t.exports='<button type="button" class="btn btn--big outline dialog__btn-close" title="Click to close FRSource contact form" aria-label="Click to close FRSource contact form"><svg xmlns:xlink="http://www.w3.org/1999/xlink" class="icon"><title>Left arrow</title><use xlink:href="#arrow" href="#arrow"></use></svg>\n</button>\n<div class="dialog__body d-f f-col">\n  <form class="f-grow d-f f-col h-100p gform" method="POST" action="https://script.google.com/macros/s/AKfycbzrISB5QwRuuwGTgkxgKp7DGENDHPcxZTcka2_LRQ0zULSf5Ec/exec">\n    <label class="topline" for="form-name"><small class="topline__item">Your</small><span class="topline__item">&nbsp;name</span></label>\n    <input type="text" name="name" id="form-name" required="" placeholder=" " autofocus="">\n\n    <label class="topline" for="form-email"><small class="topline__item">Your</small><span class="topline__item">&nbsp;email</span></label>\n    <input type="email" name="email" id="form-email" required="" placeholder=" ">\n\n    <label class="topline" for="form-message"><small class="topline__item">Your</small><span class="topline__item">&nbsp;message</span></label>\n    <textarea type="text" name="message" id="form-message" class="f-grow" required="" placeholder=" "></textarea>\n\n    <div class="d-f jc-sb">\n      <small class="tt-u d-n d-md-b">I will answer when<br>my cat falls asleep</small>\n      <button class="btn fill tt-u f-grow f-md-grow-0" type="submit">Send</button>\n    </div>\n  </form>\n</div>\n\n<svg aria-hidden="true" class="svg-sprite" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">\n  <symbol id="arrow" viewBox="0 0 131 131"><circle r="60" cx="65" cy="65" stroke-width="9" fill="none"></circle><path d="M92.98 65.53L81.11 82.45h-8.83l9.28-12.98h-50.8V61.6h50.83l-9.31-12.99h8.83l11.87 16.92z"></path></symbol>\n</svg>\n'},{}],"3YWBy":[function(){},{}]},[]);
//# sourceMappingURL=contactDialog.249e09e3.js.map
