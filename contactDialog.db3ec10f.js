!function(e,t,r,n,a,o,i,s){var c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},l="function"==typeof c[n]&&c[n],u=l.i||{},d=l.cache||{},p="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function h(t,r){if(!d[t]){if(!e[t]){if(a[t])return a[t];var o="function"==typeof c[n]&&c[n];if(!r&&o)return o(t,!0);if(l)return l(t,!0);if(p&&"string"==typeof t)return p(t);var i=Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}u.resolve=function(r){var n=e[t][1][r];return null!=n?n:r},u.cache={};var s=d[t]=new h.Module(t);e[t][0].call(s.exports,u,s,s.exports,c)}return d[t].exports;function u(e){var t=u.resolve(e);return!1===t?{}:h(t)}}h.isParcelRequire=!0,h.Module=function(e){this.id=e,this.bundle=h,this.require=p,this.exports={}},h.modules=e,h.cache=d,h.parent=l,h.distDir=void 0,h.publicUrl=void 0,h.devServer=void 0,h.i=u,h.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(h,"root",{get:function(){return c[n]}}),c[n]=h;for(var m=0;m<t.length;m++)h(t[m])}({"4Vh0U":[function(e,t,r,n){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"ContactDialogCtrl",()=>s);var o=e("url:./tpl.html"),i=a.interopDefault(o);e("./_styles.scss");class s{constructor(){this.grecaptchaCallbackResolver=()=>{},s.grecaptchaScriptLoader||this.createScriptElement(),this.element=document.createElement("dialog"),this.setupDialogElement(this.element)}async setupDialogElement(e){s.templateLoader||(s.templateLoader=fetch(i.default));let t=await s.templateLoader;e.innerHTML=await t.text(),e.querySelectorAll("input,textarea").forEach(e=>{e.setAttribute("placeholder"," ")}),e.querySelector(".dialog__btn-close").addEventListener("click",this.hide.bind(this)),e.querySelector(".gform").addEventListener("submit",this.onFormSubmit.bind(this)),this.element=e}createScriptElement(){s.grecaptchaScriptLoader=new Promise(e=>{let t=document.createElement("script");t.onload=()=>{let t=document.createElement("div");t.className="grecaptcha-wrapper",document.body.appendChild(t),window.grecaptcha.ready(()=>{window.grecaptcha.render(t,{sitekey:"6LdQaM8ZAAAAAJwBCtGEYIyh9u6be1rBOlsd-FWj",size:"invisible",callback:e=>this.grecaptchaCallbackResolver(e)}),e()})},t.src="https://www.google.com/recaptcha/api.js?render=explicit",t.defer=!0,t.async=!0,document.body.appendChild(t)})}async executeGrecaptcha(){let e=await new Promise(e=>{this.grecaptchaCallbackResolver=e,window.grecaptcha.execute()});return window.grecaptcha.reset(),e}async sendContactData(e,t=0){return new Promise(async(r,n)=>{let a="https://script.google.com/macros/s/AKfycbzrISB5QwRuuwGTgkxgKp7DGENDHPcxZTcka2_LRQ0zULSf5Ec/exec?"+e,o=await this.executeGrecaptcha(),i=new XMLHttpRequest;i.open("POST",a+"&token="+encodeURIComponent(o)),i.setRequestHeader("Content-type","text/plain;charset=utf-8"),i.onreadystatechange=()=>{if(4===i.readyState)if(200===i.status){if("success"===JSON.parse(i.responseText).result)return r();++t<3?r(this.sendContactData(e,t)):n()}else n()},i.send()})}isShown(){return"open"===this.element.getAttribute("open")}show(){requestAnimationFrame(()=>{this.element.setAttribute("open","open")})}hide(){this.element.removeAttribute("open")}async onFormSubmit(e){await s.grecaptchaScriptLoader;let t=e.currentTarget,r=t.querySelector("button");r.disabled=!0,e.preventDefault();let n=Array.prototype.slice.apply(t.querySelectorAll("input,textarea")).map(e=>encodeURIComponent(e.name)+"="+encodeURIComponent(e.value)).join("&");await this.sendContactData(n).then(()=>{r.textContent="THX!",r.classList.remove("fill"),r.classList.add("pe-n")},()=>{}),r.disabled=!1}}},{"url:./tpl.html":"luyfs","./_styles.scss":"8QASm","@parcel/transformer-js/src/esmodule-helpers.js":"023Uw"}],luyfs:[function(e,t,r,n){t.exports=import.meta.resolve("KXJBD")},{}],"8QASm":[function(){},{}]},[],0,"parcelRequire6566",{});
//# sourceMappingURL=contactDialog.db3ec10f.js.map
